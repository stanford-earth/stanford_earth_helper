<?php
/**
 * @file
 * File description.
 *
 * Long description.
 */

use Drupal\migrate\Plugin\MigrationInterface;
use Drupal\migrate\Row;
use Drupal\migrate\Plugin\MigrateSourceInterface;

/**
 * Implements hook_migrate_prepare_row().
 */
function stanford_earth_capx_migrate_prepare_row(Row $row, MigrateSourceInterface $source, MigrationInterface $migration) {

  // we need to clean up the phones data from the CAP API since it's an
  // array without keys. This is where we rewrite the array
  $phones = $row->getSourceProperty('phone');
  $newphones = [];
  foreach ($phones as $ph) {
    $newphones[] = ['phone' => $ph];
  }
  $row->setSourceProperty('phone', $newphones);
  return true;

}