langcode: en
status: true
dependencies: {  }
id: events_importer_unlisted
class: null
field_plugin_method: null
cck_plugin_method: null
migration_tags: null
migration_group: earth_events
label: 'Events Unlisted Importer'
source:
  plugin: stanford_earth_url
  data_fetcher_plugin: file
  urls:
    - 'http://events.stanford.edu/xml/drupal/v2.php?organization=1407&unlisted'
    - 'http://events.stanford.edu/xml/drupal/v2.php?organization=1409&unlisted'
    - 'http://events.stanford.edu/xml/drupal/v2.php?organization=1411&unlisted'
    - 'http://events.stanford.edu/xml/drupal/v2.php?organization=1417&unlisted'
    - 'http://events.stanford.edu/xml/drupal/v2.php?organization=79&unlisted'
    - 'http://events.stanford.edu/xml/drupal/v2.php?organization=266&unlisted'
    - 'http://events.stanford.edu/xml/drupal/v2.php?organization=1149&unlisted'
  data_parser_plugin: stanford_earth_simple_xml
  item_selector: /EventList/Event
  fields:
    -
      name: guid
      label: GUID
      selector: guid
    -
      name: title
      label: 'Event Title'
      selector: title
    -
      name: field_s_event_description
      label: Description
      selector: description
    -
      name: field_s_event_admission
      label: Admission
      selector: admissionDescription
    -
      name: field_s_event_audience
      label: Audience
      selector: audiences
    -
      name: field_s_event_date
      label: Date
      selector: isoEventDate
    -
      name: field_s_event_image
      label: 'Image URL'
      selector: imageUrl
    -
      name: field_s_event_more_info
      label: 'More info'
      selector: url
    -
      name: field_s_event_tags
      label: Tags
      selector: Keywords/tag
    -
      name: field_s_event_when
      label: When
      selector: eventDate
    -
      name: field_s_event_where
      label: Location
      selector: locationText
    -
      name: field_event_date_end_time
      label: 'End Date'
      selector: isoEventEndDate
    -
      name: field_sponsor
      label: Sponsor
      selector: sponsor
    -
      name: field_mapurl
      label: MapURL
      selector: mapUrl
    -
      name: field_contact_email
      label: 'Contact Email'
      selector: contactEmail
    -
      name: field_contact_phone
      label: 'Contact Phone'
      selector: contactPhone
  ids:
    guid:
      type: string
  constants:
    status: 1
    promote: 0
    type: stanford_event
    timezone: 25200
    basic_html: basic_html
    minimal_html: minimal_html
    source_base_path: 'http://events.stanford.edu/'
    file_destination: 'public://stanford-event/importer/'
    view_map: 'View map'
process:
  feed_urls:
    plugin: stanford_earth_feed_url
  feed_dept:
    plugin: stanford_earth_feed_dept
  status: constants/status
  type: constants/type
  promote: constants/promote
  title: title
  field_s_event_description/value: field_s_event_description
  field_s_event_description/format: constants/basic_html
  field_s_event_admission/value: field_s_event_admission
  field_s_event_admission/format: constants/basic_html
  field_s_event_audience/value: field_s_event_audience
  field_s_event_date/value:
    -
      plugin: format_date
      source: field_s_event_date
      from_format: 'Y-m-d H:i:s O'
      to_format: U
      timezone: Etc/GMT
    -
      plugin: format_date
      from_format: U
      to_format: 'Y-m-d\TH:i:s'
      timezone: Etc/GMT
  field_event_date_end_time/value:
    -
      plugin: format_date
      source: field_event_date_end_time
      from_format: 'Y-m-d H:i:s O'
      to_format: U
      timezone: Etc/GMT
    -
      plugin: format_date
      from_format: U
      to_format: 'Y-m-d\TH:i:s'
      timezone: Etc/GMT
  field_s_event_image:
    plugin: image_import
    source: field_s_event_image
    destination: constants/file_destination
    uid: 0
    title: title
    alt: '!file'
    skip_on_missing_source: true
  field_s_event_more_info/uri: field_s_event_more_info
  field_s_event_more_info/title: title
  field_mapurl/uri: field_mapurl
  field_mapurl/title: constants/view_map
  field_s_event_public/value: constants/promote
  field_s_event_when/value: field_s_event_when
  field_s_event_where/value: field_s_event_where
  field_s_event_feed_url:
    plugin: entity_lookup
    source: '@feed_urls'
    value_key: name
    bundle_key: vid
    bundle: stanford_earth_event_feeds
    entity_type: taxonomy_term
    ignore_case: true
  field_s_event_department:
    plugin: entity_lookup
    source: '@feed_dept'
    value_key: name
    bundle_key: vid
    bundle: department_program
    entity_type: taxonomy_term
    ignore_case: true
  field_sponsor: field_sponsor
  field_contact_email: field_contact_email
  field_contact_phone: field_contact_phone
destination:
  plugin: 'entity:node'
migration_dependencies: null
